# Strava Extract Pipeline Configuration

# API Configuration
api:
  base_url: "https://www.strava.com/api/v3/"
  version: "v3"
  timeout_seconds: 30
  retry_attempts: 3
  retry_backoff_factor: 2.0

# Rate Limiting Configuration (Reactive approach - only sleeps on 429)
rate_limiting:
  # Strava API limits
  short_term_limit: 100      # 100 requests per 15 minutes
  daily_limit: 1000          # 1000 requests per day

  # Sleep durations when rate limited
  short_term_sleep_minutes: 15  # Sleep when 15-min limit hit (first 429)
  daily_sleep_hours: 24         # Sleep when daily limit hit (second 429)

  # Retry configuration
  max_retries_before_daily_wait: 1  # Retries before assuming daily limit

  # UI options
  show_progress_bar: true

  # State persistence (null uses default: .rate_limit_state.json)
  state_file: null

# Pagination Configuration
pagination:
  default_page_size: 200
  max_page_size: 200
  base_page: 1

# DLT Pipeline Configuration
pipeline:
  name: "strava_datastack"
  destination: "duckdb"
  dataset_name: "strava_raw"
  progress: "log"  # Options: log, enlighten, alive_progress

# Incremental Loading Configuration
incremental:
  default_lookback_days: 30
  cursor_field: "start_date"

# Logging Configuration
logging:
  level: "INFO"  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "text"  # Options: json (structured), text (human-readable)
  log_file: "logs/strava_extract.log"  # Logs to both console and this file
  include_trace_id: true

# OpenTelemetry Configuration
telemetry:
  enabled: true
  endpoint: "http://otel-collector:4318"
  service_name: "strava-extract"
  service_namespace: "strava-datastack"
  enable_traces: true
  enable_logs: true
